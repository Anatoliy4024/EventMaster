
# PicnicBot

## Версия от 02.09.2024

## 1. Суть проекта
Проект PicnicBot предназначен для автоматизации планирования и бронирования пикников.
Пользователи взаимодействуют с ботом Telegram, чтобы выбрать дату, время, количество участников, 
стиль мероприятия и получить информацию о стоимости и условиях бронирования.

## 2. Файловая структура
Проект состоит из следующих файлов и директорий:

```plaintext
picnic_bot
├── helpers
│   ├── log
│   │   └── picnic_bot.log
│   ├── __init__.py
│   ├── db_helpers.py
│   └── order_calculation.py
├── keyboards
│   ├── __init__.py
│   └── picnic_keyboards.py
├── step_handlers
│   ├── __init__.py
│   ├── abstract_functions.py
│   ├── calculations.py
│   ├── message_handlers.py
│   └── order_info_sender.py
├── __init__.py
└── main.py
```

## 3. Архитектура

### 3.1 Принцип модульности
В проекте реализован принцип модульности, разделяющий основные функциональные компоненты на отдельные модули:

- **Основные модули**: обрабатывают взаимодействие с пользователями, включая выбор даты и времени,
    расчет стоимости и управление заказами.
- **Вспомогательные модули**: управляют базой данных, логированием и настройками.

### 3.2 Перечень модулей с их названиями

1. **Модуль 1** (Основной)
   - Название: `main.py`
   - Описание: Основной файл, запускающий PicnicBot и обрабатывающий взаимодействие с пользователями.
   - Функции: Инициализация бота, добавление обработчиков сообщений, запуск.

2. **Модуль 2** (Вспомогательный)
   - Название: `helpers/db_helpers.py`
   - Описание: Вспомогательные функции для работы с базой данных.
   - Функции: `picnic_db_operations()`

3. **Модуль 3** (Вспомогательный)
   - Название: `helpers/order_calculation.py`
   - Описание: Функции для расчета стоимости заказа.
   - Функции: `calculate_total_cost()`

4. **Модуль 4** (Основной)
   - Название: `keyboards/picnic_keyboards.py`
   - Описание: Создание интерактивных клавиатур для взаимодействия с пользователями.
   - Функции: `generate_calendar_keyboard()`, `generate_time_selection_keyboard()`,
       `generate_person_selection_keyboard()`, `generate_party_styles_keyboard()`

5. **Модуль 5** (Основной)
   - Название: `step_handlers/message_handlers.py`
   - Описание: Обработка различных шагов сценария взаимодействия с пользователем.
   - Функции: `handle_message()`, `handle_name()`, `handle_preferences()`, `handle_city()`

6. **Модуль 6** (Вспомогательный)
   - Название: `step_handlers/abstract_functions.py`
   - Описание: Общие функции для работы с базой данных и выполнения SQL-запросов.
   - Функции: `create_connection()`, `execute_query()`, `execute_query_with_retry()`

7. **Модуль 7** (Вспомогательный)
   - Название: `step_handlers/order_info_sender.py`
   - Описание: Функции для отправки информации о заказе администратору и Ирине.
   - Функции: `send_order_info_to_admin()`, `send_message_to_irina()`

8. **Модуль 8** (Вспомогательный)
   - Название: `step_handlers/calculations.py`
   - Описание: Функции для расчета стоимости заказа.
   - Функции: `calculate_total_cost()`

## 4. Новые компоненты в версии 2.0

### 4.1 Добавлены следующие модули

1. **`step_handlers/order_info_sender.py`**
   - Назначение: Отправка информации о заказе администратору и Ирине.
   - Особенности: Обеспечивает интеграцию с AdminBot для обработки заказов.

2. **`step_handlers/abstract_functions.py`**
   - Назначение: Вспомогательные функции для работы с базой данных.
   - Особенности: Включает функции для подключения к базе данных и выполнения SQL-запросов с повторными попытками.

### 5. Примечания

- В новой версии 2.0 добавлена возможность отправки уведомлений администраторам
- и поддержка работы с базой данных через новые модули.
- Улучшена структура логирования и обработки ошибок для упрощения отладки и мониторинга работы бота.

